- hosts: webservers
  become: true
  become_user: root
  tasks:
  - name: Install kubectl
    command: [curl -LO https://storage.googleapis.com/kubernetes-release/release/`curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt`/bin/linux/amd64/kubectl, chmod +x ./kubectl, sudo mv ./kubectl /usr/local/bin/kubectl]
  - name: copy deployment file to kubernetes master 
    copy:
      src: ./kubernetes.yml
      dest: /etc/
  # - name: delete the previous of kubernetes objects 
  #   command: kubectl delete -f /etc/kubernetes.yml
  - name: Create a Deployment by reading the definition from a local file
    command: kubectl apply -f /etc/kubernetes.yml